<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Lesson 14</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1504">
  <!-- this script changes the anchor position -->
  <!-- http://jsfiddle.net/ianclark001/rkocah23/ -->
<script>
(function(document, history, location) {
  var HISTORY_SUPPORT = !!(history && history.pushState);

  var anchorScrolls = {
    ANCHOR_REGEX: /^#[^ ]+$/,
    OFFSET_HEIGHT_PX: 65,

    /**
     * Establish events, and fix initial scroll position if a hash is provided.
     */
    init: function() {
      this.scrollToCurrent();
      $(window).on('hashchange', $.proxy(this, 'scrollToCurrent'));
      $('body').on('click', 'a', $.proxy(this, 'delegateAnchors'));
    },

    /**
     * Return the offset amount to deduct from the normal scroll position.
     * Modify as appropriate to allow for dynamic calculations
     */
    getFixedOffset: function() {
      return this.OFFSET_HEIGHT_PX;
    },

    /**
     * If the provided href is an anchor which resolves to an element on the
     * page, scroll to it.
     * @param  {String} href
     * @return {Boolean} - Was the href an anchor.
     */
    scrollIfAnchor: function(href, pushToHistory) {
      var match, anchorOffset;

      if(!this.ANCHOR_REGEX.test(href)) {
        return false;
      }

      match = document.getElementById(href.slice(1));

      if(match) {
        anchorOffset = $(match).offset().top - this.getFixedOffset();
        $('html, body').animate({ scrollTop: anchorOffset});

        // Add the state to history as-per normal anchor links
        if(HISTORY_SUPPORT && pushToHistory) {
          history.pushState({}, document.title, location.pathname + href);
        }
      }

      return !!match;
    },
    
    /**
     * Attempt to scroll to the current location's hash.
     */
    scrollToCurrent: function(e) {
      if(this.scrollIfAnchor(window.location.hash) && e) {
        e.preventDefault();
      }
    },

    /**
     * If the click event's target was an anchor, fix the scroll position.
     */
    delegateAnchors: function(e) {
      var elem = e.target;

      if(this.scrollIfAnchor(elem.getAttribute('href'), true)) {
        e.preventDefault();
      }
    }
  };

    $(document).ready($.proxy(anchorScrolls, 'init'));
})(window.document, window.history, window.location);
</script>

</head>
<body>
</body>
</html>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">An R Tutorial for Beginners</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fas fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="about.html">
    <span class="fas fa-info-circle"></span>
     
    About
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-bars"></span>
     
    Lessons
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Introduction</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="R-course_lesson-1.html">Lesson 1</a>
        </li>
        <li>
          <a href="R-course_lesson-2.html">Lesson 2</a>
        </li>
        <li>
          <a href="R-course_lesson-3.html">Lesson 3</a>
        </li>
        <li>
          <a href="R-course_lesson-4.html">Lesson 4</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Data Preparation</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="R-course_lesson-5.html">Lesson 5</a>
        </li>
        <li>
          <a href="R-course_lesson-6.html">Lesson 6</a>
        </li>
        <li>
          <a href="R-course_lesson-7.html">Lesson 7</a>
        </li>
        <li>
          <a href="R-course_lesson-8.html">Lesson 8</a>
        </li>
        <li>
          <a href="R-course_lesson-9.html">Lesson 9</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Programming</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="R-course_lesson-10.html">Lesson 10</a>
        </li>
        <li>
          <a href="R-course_lesson-11.html">Lesson 11</a>
        </li>
        <li>
          <a href="R-course_lesson-12.html">Lesson 12</a>
        </li>
        <li>
          <a href="R-course_lesson-13.html">Lesson 13</a>
        </li>
        <li>
          <a href="R-course_lesson-14.html">Lesson 14</a>
        </li>
        <li>
          <a href="R-course_lesson-15.html">Lesson 15</a>
        </li>
        <li>
          <a href="R-course_lesson-16.html">Lesson 16</a>
        </li>
        <li>
          <a href="R-course_lesson-17.html">Lesson 17</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Data Analysis</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="R-course_lesson-18.html">Lesson 18</a>
        </li>
        <li>
          <a href="R-course_lesson-19.html">Lesson 19</a>
        </li>
        <li>
          <a href="R-course_lesson-20.html">Lesson 20</a>
        </li>
        <li>
          <a href="R-course_lesson-21.html">Lesson 21</a>
        </li>
        <li>
          <a href="R-course_lesson-22.html">Lesson 22</a>
        </li>
      </ul>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Import Data into R: Read CSV, Excel, SPSS, Stata, SAS Files</h1>

</div>


<div id="read-csv" class="section level1">
<h1>Read CSV</h1>
<p>One of the most widely data store is the .csv (comma-separated values) file formats. R loads an array of libraries during the start-up, including the utils package. This package is convenient to open csv files combined with the reading.csv() function. Here is the syntax for read.csv</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">read.csv</span>(file, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span></code></pre></div>
<p>Argument:</p>
<ul>
<li>file: PATH where the file is stored</li>
<li>header: confirm if the file has a header or not, by default, the header is set to TRUE</li>
<li>sep: the symbol used to split the variable. By default, <code>,</code>.</li>
</ul>
<p>We will read the data file name mtcats. The csv file is stored online. If your .csv file is stored locally, you can replace the PATH inside the code snippet. Don’t forget to wrap it inside ’ ’. The PATH needs to be a string value.</p>
<p>For mac user, the path for the download folder is:</p>
<p><code>"/Users/USERNAME/Downloads/FILENAME.csv"</code></p>
<p>For windows user:</p>
<p><code>"C:\Users\USERNAME\Downloads\FILENAME.csv"</code></p>
<p>Note that, we should always specify the extension of the file name.</p>
<ul>
<li>.csv</li>
<li>.xlsx</li>
<li>.txt</li>
<li>…</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>PATH &lt;-<span class="st"> &#39;https://raw.githubusercontent.com/guru99-edu/R-Programming/master/mtcars.csv&#39;</span>                </span>
<span id="cb2-2"><a href="#cb2-2"></a>df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(PATH, <span class="dt">header =</span>  <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&#39;,&#39;</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="kw">length</span>(df)</span></code></pre></div>
<pre><code>## [1] 12</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">class</span>(df<span class="op">$</span>X)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p>R, by default, returns character values as Factor. We can turn off this setting by adding stringsAsFactors = FALSE.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>PATH &lt;-<span class="st"> &#39;https://raw.githubusercontent.com/guru99-edu/R-Programming/master/mtcars.csv&#39;</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>df &lt;-<span class="kw">read.csv</span>(PATH, <span class="dt">header =</span><span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&#39;,&#39;</span>, <span class="dt">stringsAsFactors =</span><span class="ot">FALSE</span>)</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="kw">class</span>(df<span class="op">$</span>X)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p>The class for the variable X is now a character.</p>
</div>
<div id="read-excel-files" class="section level1">
<h1>Read Excel files</h1>
<p>Excel files are very popular among data analysts. Spreadsheets are easy to work with and flexible. R is equipped with a library readxl to import Excel spreadsheet.</p>
<p>Use this code</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">require</span>(readxl)</span></code></pre></div>
<pre><code>## Loading required package: readxl</code></pre>
<p>to check if readxl is installed in your machine. If you install r with r-conda-essential, the library is already installed. You should see in the command window:</p>
<p>If the package does not exit, you can install it with the conda library or in the terminal, use conda install -c mittner r-readxl.</p>
<p>Use the following command to load the library to import excel files.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">library</span>(readxl)</span></code></pre></div>
</div>
<div id="readxl_example" class="section level1">
<h1>readxl_example()</h1>
<p>We use the examples included in the package readxl during this tutorial.</p>
<p>Use code</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">readxl_example</span>()</span></code></pre></div>
<pre><code>##  [1] &quot;clippy.xls&quot;    &quot;clippy.xlsx&quot;   &quot;datasets.xls&quot;  &quot;datasets.xlsx&quot; &quot;deaths.xls&quot;    &quot;deaths.xlsx&quot;   &quot;geometry.xls&quot; 
##  [8] &quot;geometry.xlsx&quot; &quot;type-me.xls&quot;   &quot;type-me.xlsx&quot;</code></pre>
<p>to see all the available spreadsheets in the library.</p>
<p>To check the location of the spreadsheet named clippy.xls, simple use</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">readxl_example</span>(<span class="st">&quot;geometry.xls&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/readxl/extdata/geometry.xls&quot;</code></pre>
</div>
<div id="read_excel" class="section level1">
<h1>read_excel()</h1>
<p>The function read_excel() is of great use when it comes to opening xls and xlsx extention.</p>
<p>The syntax is:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">read_excel</span>(PATH, <span class="dt">sheet =</span> <span class="ot">NULL</span>, <span class="dt">range =</span> <span class="ot">NULL</span>, <span class="dt">col_names =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>Arguments:</p>
<p>-PATH: Path where the excel is located -sheet: Select the sheet to import. By default, all -range: Select the range to import. By default, all non-null cells -col_names: Select the columns to import. By default, all non-null columns</p>
<p>We can import the spreadsheets from the readxl library and count the number of columns in the first sheet.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># Store the path of `datasets.xlsx`</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>example &lt;-<span class="st"> </span><span class="kw">readxl_example</span>(<span class="st">&quot;datasets.xlsx&quot;</span>)</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co"># Import the spreadsheet</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>df &lt;-<span class="st"> </span><span class="kw">read_excel</span>(example)</span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co"># Count the number of columns</span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="kw">length</span>(df)</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
</div>
<div id="excel_sheets" class="section level1">
<h1>excel_sheets()</h1>
<p>The file datasets.xlsx is composed of 4 sheets. We can find out which sheets are available in the workbook by using excel_sheets() function</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>example &lt;-<span class="st"> </span><span class="kw">readxl_example</span>(<span class="st">&quot;datasets.xlsx&quot;</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="kw">excel_sheets</span>(example)</span></code></pre></div>
<pre><code>## [1] &quot;iris&quot;     &quot;mtcars&quot;   &quot;chickwts&quot; &quot;quakes&quot;</code></pre>
<p>If a worksheet includes many sheets, it is easy to select a particular sheet by using the sheet arguments. We can specify the name of the sheet or the sheet index. We can verify if both function returns the same output with identical().</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>example &lt;-<span class="st"> </span><span class="kw">readxl_example</span>(<span class="st">&quot;datasets.xlsx&quot;</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a>quake &lt;-<span class="st"> </span><span class="kw">read_excel</span>(example, <span class="dt">sheet =</span> <span class="st">&quot;quakes&quot;</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a>quake_<span class="dv">1</span> &lt;-<span class="kw">read_excel</span>(example, <span class="dt">sheet =</span> <span class="dv">4</span>)</span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="kw">identical</span>(quake, quake_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>We can control what cells to read in 2 ways</p>
<ol style="list-style-type: decimal">
<li>Use n_max argument to return n rows</li>
<li>Use range argument combined with cell_rows or cell_cols</li>
</ol>
<p>For example, we set n_max equals to 5 to import the first five rows.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># Read the first five row: with header</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>iris &lt;-<span class="st"> </span><span class="kw">read_excel</span>(example, <span class="dt">n_max =</span> <span class="dv">5</span>, <span class="dt">col_names =</span> <span class="ot">TRUE</span>)</span>
<span id="cb22-3"><a href="#cb22-3"></a>iris</span></code></pre></div>
<div class="kable-table">

<table>
<thead>
<tr>
<th style="text-align:right;">
Sepal.Length
</th>
<th style="text-align:right;">
Sepal.Width
</th>
<th style="text-align:right;">
Petal.Length
</th>
<th style="text-align:right;">
Petal.Width
</th>
<th style="text-align:left;">
Species
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
5.1
</td>
<td style="text-align:right;">
3.5
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.9
</td>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.7
</td>
<td style="text-align:right;">
3.2
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
3.1
</td>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
5.0
</td>
<td style="text-align:right;">
3.6
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
</tbody>
</table>
</div>
<p>If we change col_names to FALSE, R creates the headers automatically.</p>
<pre><code>## New names:
## * `` -&gt; ...1
## * `` -&gt; ...2
## * `` -&gt; ...3
## * `` -&gt; ...4
## * `` -&gt; ...5</code></pre>
<p align="center">
<img src="imgblock14/img1.png" />
</p>
<p>We can also use the argument range to select rows and columns in the spreadsheet. In the code below, we use the excel style to select the range A1 to B5.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># Read rows A1 to B5</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>example_<span class="dv">1</span> &lt;-<span class="kw">read_excel</span>(example, <span class="dt">range =</span> <span class="st">&quot;A1:B5&quot;</span>, <span class="dt">col_names =</span><span class="ot">TRUE</span>)</span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="kw">dim</span>(example_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 4 2</code></pre>
<p>We can see that the example_1 returns 4 rows with 2 columns. The dataset has header, that the reason the dimension is 4x2.</p>
<p align="center">
<img src="imgblock14/img2.png" />
</p>
<p>In the second example, we use the function cell_rows() which controls the range of rows to return. If we want to import the rows 1 to 5, we can set cell_rows(1:5). Note that, cell_rows(1:5) returns the same output as cell_rows(5:1).</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># Read rows 1 to 5</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>example_<span class="dv">2</span> &lt;-<span class="kw">read_excel</span>(example, <span class="dt">range =</span><span class="kw">cell_rows</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>),<span class="dt">col_names =</span><span class="ot">TRUE</span>)          </span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="kw">dim</span>(example_<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 4 5</code></pre>
<p>The example_2 however is a 4x5 matrix. The iris dataset has 5 columns with header. We return the first four rows with header of all columns</p>
<p align="center">
<img src="imgblock14/img3.png" />
</p>
<p>In case we want to import rows which do not begin at the first row, we have to include col_names = FALSE. If we use range = cell_rows(2:5), it becomes obvious our data frame does not have header anymore.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>iris_row_with_header &lt;-<span class="st"> </span><span class="kw">read_excel</span>(example, <span class="dt">range =</span> <span class="kw">cell_rows</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>), <span class="dt">col_names =</span> <span class="ot">TRUE</span>)</span>
<span id="cb28-2"><a href="#cb28-2"></a>iris_row_no_header &lt;-<span class="st"> </span><span class="kw">read_excel</span>(example, <span class="dt">range =</span> <span class="kw">cell_rows</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>), <span class="dt">col_names =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## New names:
## * `` -&gt; ...1
## * `` -&gt; ...2
## * `` -&gt; ...3
## * `` -&gt; ...4
## * `` -&gt; ...5</code></pre>
<p align="center">
<img src="imgblock14/img4.png" />
</p>
<p>We can select the columns with the letter, like in Excel.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="co"># Select columns A and B</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>col &lt;-<span class="kw">read_excel</span>(example, <span class="dt">range =</span><span class="kw">cell_cols</span>(<span class="st">&quot;A:B&quot;</span>))</span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="kw">dim</span>(col)</span></code></pre></div>
<pre><code>## [1] 150   2</code></pre>
<p><strong>Note:</strong> <code>range = cell_cols("A:B")</code>, returns output all cells with non-null value. The dataset contains 150 rows, therefore, read_excel() returns rows up to 150. This is verified with the dim() function.</p>
<p>read_excel() returns NA when a symbol without numerical value appears in the cell. We can count the number of missing values with the combination of two functions</p>
<ul>
<li>sum</li>
<li>is.na</li>
</ul>
<p>Here is the code</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>iris_na &lt;-<span class="st"> </span><span class="kw">read_excel</span>(example, <span class="dt">na =</span> <span class="st">&quot;setosa&quot;</span>)</span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="kw">sum</span>(<span class="kw">is.na</span>(iris_na))</span></code></pre></div>
<pre><code>## [1] 50</code></pre>
<p>We have 50 values missing, which are the rows belonging to the setosa species.</p>
</div>
<div id="import-data-from-other-statistical-software" class="section level1">
<h1>Import data from other Statistical software</h1>
<p>We will import different files format with the heaven package. This package support SAS, STATA and SPSS softwares. We can use the following function to open different types of dataset, according to the extension of the file:</p>
<ul>
<li>SAS: read_sas()</li>
<li>STATA: read_dta() (or read_stata(), which are identical)</li>
<li>SPSS: read_sav() or read_por(). We need to check the extension</li>
</ul>
<p>Only one argument is required within these function. We need to know the PATH where the file is stored. That’s it, we are ready to open all the files from SAS, STATA and SPSS. These three function accepts an URL as well.</p>
</div>
<div id="read-sas" class="section level1">
<h1>Read sas</h1>
<p>For our example, we are going to use the admission dataset from IDRE.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>PATH_sas &lt;-<span class="st"> &#39;https://github.com/guru99-edu/R-Programming/blob/master/binary.sas7bdat?raw=true&#39;</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>df &lt;-<span class="st"> </span><span class="kw">read_sas</span>(PATH_sas)</span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="kw">head</span>(df)</span></code></pre></div>
<div class="kable-table">

<table>
<thead>
<tr>
<th style="text-align:right;">
ADMIT
</th>
<th style="text-align:right;">
GRE
</th>
<th style="text-align:right;">
GPA
</th>
<th style="text-align:right;">
RANK
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
380
</td>
<td style="text-align:right;">
3.61
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
660
</td>
<td style="text-align:right;">
3.67
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
800
</td>
<td style="text-align:right;">
4.00
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
640
</td>
<td style="text-align:right;">
3.19
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
520
</td>
<td style="text-align:right;">
2.93
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
760
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="read-stata" class="section level1">
<h1>Read STATA</h1>
<p>For STATA data files you can use read_dta(). We use exactly the same dataset but store in .dta file.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>PATH_stata &lt;-<span class="st"> &#39;https://github.com/guru99-edu/R-Programming/blob/master/binary.dta?raw=true&#39;</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>df &lt;-<span class="st"> </span><span class="kw">read_dta</span>(PATH_stata)</span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="kw">head</span>(df)</span></code></pre></div>
<div class="kable-table">

<table>
<thead>
<tr>
<th style="text-align:right;">
admit
</th>
<th style="text-align:right;">
gre
</th>
<th style="text-align:right;">
gpa
</th>
<th style="text-align:right;">
rank
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
380
</td>
<td style="text-align:right;">
3.61
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
660
</td>
<td style="text-align:right;">
3.67
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
800
</td>
<td style="text-align:right;">
4.00
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
640
</td>
<td style="text-align:right;">
3.19
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
520
</td>
<td style="text-align:right;">
2.93
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
760
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="read-spss" class="section level1">
<h1>Read SPSS</h1>
<p>We use the read_sav()function to open a SPSS file. The file extension “.sav”</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>PATH_spss &lt;-<span class="st"> &#39;https://github.com/guru99-edu/R-Programming/blob/master/binary.sav?raw=true&#39;</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>df &lt;-<span class="st"> </span><span class="kw">read_sav</span>(PATH_spss)</span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="kw">head</span>(df)</span></code></pre></div>
<div class="kable-table">

<table>
<thead>
<tr>
<th style="text-align:right;">
admit
</th>
<th style="text-align:right;">
gre
</th>
<th style="text-align:right;">
gpa
</th>
<th style="text-align:right;">
rank
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
380
</td>
<td style="text-align:right;">
3.61
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
660
</td>
<td style="text-align:right;">
3.67
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
800
</td>
<td style="text-align:right;">
4.00
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
640
</td>
<td style="text-align:right;">
3.19
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
520
</td>
<td style="text-align:right;">
2.93
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
760
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="best-practices-for-data-import" class="section level1">
<h1>Best practices for Data Import</h1>
<p>When we want to import data into R, it is useful to implement following checklist. It will make it easy to import data correctly into R:</p>
<ul>
<li>The typical format for a spreadsheet is to use the first rows as the header (usually variables name).</li>
<li>Avoid to name a dataset with blank spaces; it can lead to interpreting as a separate variable.</li>
<li>Alternatively, prefer to use ’_’ or ‘-.’</li>
<li>Short names are preferred</li>
<li>Do not include symbol in the name: i.e.: exchange_rate_$_€ is not correct. Prefer to name it: exchange_rate_dollar_euro</li>
<li>Use NA for missing values otherwise; we need to clean the format later.</li>
</ul>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<p>Following table summarizes the function to use in order to import different types of file in R. The column one states the library related to the function. The last column refers to the default argument.</p>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Library
</th>
<th style="text-align:left;">
Objective
</th>
<th style="text-align:left;">
Function
</th>
<th style="text-align:left;">
Default.Argument
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
utils
</td>
<td style="text-align:left;">
Read CSV file
</td>
<td style="text-align:left;">
read.csv()
</td>
<td style="text-align:left;">
file, header = , TRUE, sep = “,”
</td>
</tr>
<tr>
<td style="text-align:left;">
readxl
</td>
<td style="text-align:left;">
Read EXCEL file
</td>
<td style="text-align:left;">
read_excel()
</td>
<td style="text-align:left;">
path, range = NULL, col_names = TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
haven
</td>
<td style="text-align:left;">
Read SAS file
</td>
<td style="text-align:left;">
read_sas()
</td>
<td style="text-align:left;">
path
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Read STATA file
</td>
<td style="text-align:left;">
read_stata()
</td>
<td style="text-align:left;">
path
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Read SPSS file
</td>
<td style="text-align:left;">
read_sav()
</td>
<td style="text-align:left;">
path
</td>
</tr>
</tbody>
</table>
<!-- | Library | Objective | Function | Default Arguments | -->
<!-- |:--------|:----------|:---------|:------------------| -->
<!-- | utils | Read CSV file | read.csv() | file, header = , TRUE, sep = "," | -->
<!-- | readxl | Read EXCEL file | read_excel() | path, range = NULL, col_names = TRUE | -->
<!-- | haven | Read SAS file | read_sas() | path | -->
<!-- | haven | Read STATA file | read_stata() | path | -->
<!-- | haven | Read SPSS fille | read_sav() | path | -->
<p>Following table shows the different ways to import a selection with read_excel() function.</p>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Function
</th>
<th style="text-align:left;">
Objective
</th>
<th style="text-align:left;">
Arguments
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
read_excel()
</td>
<td style="text-align:left;">
Read n number of rows
</td>
<td style="text-align:left;">
n_max = 10
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Select rows and columns like in excel
</td>
<td style="text-align:left;">
range = “A1:D10”
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Select rows with indexes
</td>
<td style="text-align:left;">
range = cell_rows(1:3)
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Select columns with letters
</td>
<td style="text-align:left;">
range = cell_cols(“A:C”)
</td>
</tr>
</tbody>
</table>
<!-- | Function | Objectives | Arguments | -->
<!-- |:---------|:-----------|:----------| -->
<!-- | read_excel() | Read n number of rows | n_max = 10 | -->
<!-- |              | Select rows and columns like in excel | range = "A1:D10" | -->
<!-- |              | Select rows with indexes | range = cell_rows(1:3) | -->
<!-- |              | Select columns with letters | range = cell_cols("A:C") | -->
</div>

&nbsp;
<hr />
<p style="text-align: center;">A work by <a href="https://www.unipa.it/persone/docenti/s/gianluca.sottile">Gianluca Sottile</a></p>
<p style="text-align: center;"><span style="color: #808080;"><em>gianluca.sottile@unipa.it</em></span></p>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

&nbsp;


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
