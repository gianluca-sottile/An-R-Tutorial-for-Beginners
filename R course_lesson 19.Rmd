---
title: "How to Make a Boxplot in R (with Example)"
pagetitle: "Lesson 19"
editor_options:
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  fig.align = "center",
  message = FALSE,
  warning = FALSE
)
```

`geom_boxplot()` from **ggplot2** creates a box plot. A box plot visualizes the distribution of a numeric variable using quartiles and helps detect potential outliers.

We will use the `airquality` dataset (New York air quality measurements from May to September 1973). We will focus on:

- `Ozone` (numeric)
- `Wind` (numeric)
- `Month` (May to September; we will treat it as a factor)

# Create a box plot

Before plotting, we will:

1. Start from `airquality`
2. Drop variables we won’t use
3. Convert `Month` to an ordered factor with labels
4. Create a new categorical variable for the day of the month: Begin / Middle / End
5. Remove missing values

```{r}
library(dplyr)
library(ggplot2)

data_air <- airquality |>
  select(-Solar.R, -Temp) |>
  mutate(
    Month = factor(
      Month,
      ordered = TRUE,
      labels = c("May", "June", "July", "August", "September")
    ),
    day_cat = case_when(
      Day < 10 ~ "Begin",
      Day < 20 ~ "Middle",
      TRUE ~ "End"
    ) |>
      factor(levels = c("Begin", "Middle", "End"))
  )

glimpse(data_air)

data_air_nona <- data_air |>
  tidyr::drop_na()
```

# Basic box plot

Let’s plot the distribution of ozone by month.

```{r}
box_plot <- ggplot(data_air_nona, aes(x = Month, y = Ozone))

box_plot +
  geom_boxplot() +
  theme_classic()
```

# Flip the orientation

```{r}
box_plot +
  geom_boxplot() +
  coord_flip() +
  theme_classic()
```

# Customize outliers

You can change the outlier appearance (color, shape, and size).

```{r}
box_plot +
  geom_boxplot(
    outlier.colour = "red",
    outlier.shape = 2,
    outlier.size = 2.8
  ) +
  theme_classic()
```

# Add a summary statistic (mean)

You can add the mean as an overlay point. Note: in recent ggplot2 versions, use `fun =` (the old `fun.y` is deprecated). [web:600]

```{r}
box_plot +
  geom_boxplot() +
  stat_summary(
    fun = mean,
    geom = "point",
    size = 3,
    color = "steelblue"
  ) +
  theme_classic()
```

# Box plot with dots

A dot layer helps show individual observations.

```{r}
box_plot +
  geom_boxplot() +
  geom_dotplot(
    binaxis = "y",
    stackdir = "center",
    dotsize = 0.8
  ) +
  theme_classic()
```

# Control aesthetics

## Color boxes by group

```{r}
ggplot(data_air_nona, aes(x = Month, y = Ozone, color = Month)) +
  geom_boxplot() +
  theme_classic() +
  guides(color = "none")
```

# Box plot with multiple groups

Here we compare ozone by month, further split by `day_cat`.

```{r}
ggplot(data_air_nona, aes(x = Month, y = Ozone, fill = day_cat)) +
  geom_boxplot() +
  theme_classic() +
  labs(fill = "Day in month")
```

# Box plot with jittered points

Jittered points are another common way to display observations and reduce overlap.

```{r}
box_plot +
  geom_boxplot() +
  geom_jitter(
    width = 0.18,
    shape = 15,
    color = "steelblue",
    alpha = 0.7
  ) +
  theme_classic()
```

For comparison, here is the same plot using `geom_point()` without jitter:

```{r}
box_plot +
  geom_boxplot() +
  geom_point(shape = 5, color = "steelblue") +
  theme_classic()
```

# Notched box plot

A notched box plot narrows the box around the median. Non-overlapping notches provide visual evidence that medians may differ.

\[
\text{median} \pm 1.57 \times \frac{\text{IQR}}{\sqrt{n}}
\]

```{r}
box_plot +
  geom_boxplot(notch = TRUE) +
  theme_classic()
```

# Summary

```{r, echo=FALSE}
library(knitr)

dt <- data.frame(
  Objective = c("Basic box plot", "Flip orientation", "Notched box plot", "Box plot with jitter"),
  Code = c(
    "ggplot(df, aes(x, y)) + geom_boxplot()",
    "ggplot(df, aes(x, y)) + geom_boxplot() + coord_flip()",
    "ggplot(df, aes(x, y)) + geom_boxplot(notch = TRUE)",
    "ggplot(df, aes(x, y)) + geom_boxplot() + geom_jitter(width = 0.18)"
  )
)

knitr::kable(dt)
```
