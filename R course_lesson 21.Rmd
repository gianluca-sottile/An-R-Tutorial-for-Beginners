---
title: "T Test in R: One-sample and Paired (with Example)"
pagetitle: "Lesson 21"
editor_options:
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  fig.align = "center",
  message = FALSE,
  warning = FALSE
)
```

# What is statistical inference?

Statistical inference is about drawing conclusions from data under uncertainty. In practice, it often means using hypothesis tests to decide whether the data provide enough evidence against a default assumption (the null hypothesis).

A common tool is the **t-test** (also called **Student’s t-test**), which can be used to test hypotheses about means:

- One-sample t-test: compare the mean of one sample to a reference value.
- Paired t-test: compare two measurements taken on the same units (before/after, matched pairs). [web:571]

# What is a t-test?

A t-test compares two competing hypotheses:

- \(H_0\): the mean (or mean difference) equals a reference value.
- \(H_1\): the mean (or mean difference) is different (two-sided) or greater/less (one-sided).

In R, the base function is `t.test()`:

```{r, eval=FALSE}
t.test(x, y = NULL, mu = 0, alternative = "two.sided", paired = FALSE, var.equal = FALSE)
```

Key arguments:

- `x`: numeric vector.
- `y`: second numeric vector (for two-sample tests).
- `mu`: reference mean (or reference mean difference for paired tests).
- `paired`: set to `TRUE` for paired data. [web:570]
- `var.equal`: relevant for **two-sample unpaired** tests; it uses a pooled variance estimate when `TRUE`. [web:570]

# One-sample t-test

A one-sample t-test compares the mean of a sample to a theoretical mean \(\mu\).

\[
t = \frac{\bar{x} - \mu}{s/\sqrt{n}}
\]

where \(\bar{x}\) is the sample mean, \(s\) the sample standard deviation, and \(n\) the sample size.

The result includes a p-value. With a significance level of 0.05:

- p-value < 0.05: reject \(H_0\).
- p-value ≥ 0.05: insufficient evidence to reject \(H_0\).

## Example: cookie sugar content

Suppose each cookie should contain 10 grams of sugar. You sample 30 cookies and measure sugar content.

```{r}
set.seed(123)
sugar_cookie <- rnorm(30, mean = 9.99, sd = 0.04)
head(sugar_cookie)
```

Test:

- \(H_0: \mu = 10\)
- \(H_1: \mu \neq 10\)

```{r}
t.test(sugar_cookie, mu = 10)
```

If the p-value is above 0.05, you do not have enough evidence that the mean sugar content differs from 10 grams.

# Paired t-test

A paired t-test is used when the two samples are **dependent** (same units measured twice, or matched pairs). The test is equivalent to a one-sample t-test on the differences \(d = x - y\). [web:572][web:570]

## Example: sales before vs after a discount program

A company tracks daily sales for the same shop for 7 days before and 7 days after a discount program.

```{r}
set.seed(123)

sales_before <- rnorm(7, mean = 50000, sd = 50)
sales_after  <- rnorm(7, mean = 50075, sd = 50)

t.test(sales_before, sales_after, paired = TRUE)
```

Notes:

- Use `paired = TRUE` for paired data. [web:571]
- In a paired test, `var.equal` is not meaningful in the same way as in an unpaired two-sample test, because the test works on a single vector of differences. [web:572]

# Summary

The t-test is a fundamental tool in inferential statistics for testing hypotheses about means.

```{r, echo=FALSE}
library(knitr)

dt <- data.frame(
  Test = c("One-sample t-test", "Paired t-test"),
  Hypothesis = c(
    "Mean of a sample differs from a reference value",
    "Mean difference between paired measurements differs from 0"
  ),
  Code = c(
    "t.test(x, mu = mu0)",
    "t.test(x, y, paired = TRUE)"
  )
)

knitr::kable(dt)
```
